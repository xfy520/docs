kind: pipeline
type: docker
name: docs

workspace:
  base: /app
  path: drone/docs

clone:
  disable: true

steps:
  - name: clone
    pull: if-not-exists
    image: alpine/git:v2.30.2
    environment:
      DRONE_GIT_URL:
        from_secret: drone_git_url
      TEST: "Hello World"
    commands:
      - sed -i "s#\"drone_git_url\":[^,]*#\"drone_git_url\":$DRONE_GIT_URL#g" .env
      - echo $DRONE_GIT_URL
      - echo $TEST
      - echo $drone_git_url

trigger:
  branch:
    - main
  event:
    - push

---
kind: secret
name: drone_git_url
get:
  path: drone/data/docs
  name: drone_git_url

